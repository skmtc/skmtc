---
title: "RenderContext"
description: "The rendering context for the final phase of the SKMTC transformation pipeline."
kind: "class"
filename: "skmtc/deno/core/context/RenderContext.ts"
line: 256
---

# RenderContext

The rendering context for the final phase of the SKMTC transformation pipeline.

`RenderContext` is responsible for taking the generated artifacts from the generation
phase and rendering them into their final form with proper formatting, path resolution,
and file preparation. It handles code formatting via Prettier, path normalization,
and produces the final artifacts ready for writing to the filesystem.

This context represents the culmination of the three-phase SKMTC pipeline, transforming
generator outputs into production-ready code files with proper formatting and structure.

## Key Features

- **Code Formatting**: Automatic Prettier formatting for generated TypeScript/JavaScript code
- **Path Resolution**: Intelligent path resolution with base path support
- **Content Collation**: Combines all generated content into organized file structures
- **Metadata Generation**: Tracks file statistics (lines, characters) and relationships
- **Error Tracking**: Comprehensive error handling with Sentry integration
- **Performance Monitoring**: Built-in tracing and performance measurement


## Example

Basic rendering usage
```typescript
import { RenderContext } from '@skmtc/core';

const renderContext = new RenderContext({
  files: generatedFiles,
  previews: previewData,
  mappings: mappingData,
  prettierConfig: {
    semi: false,
    singleQuote: true,
    trailingComma: 'all'
  },
  basePath: './src/generated',
  stackTrail: traceStack,
  logger: myLogger,
  captureCurrentResult: (result) => console.log(result)
});

const rendered = await renderContext.render();

// Access rendered files
Object.entries(rendered.artifacts).forEach(([path, content]) => {
  console.log(`Rendered ${path}: ${rendered.files[path].lines} lines`);
  // Write to filesystem
  await Deno.writeTextFile(path, content);
});
```


## Example

With custom Prettier configuration
```typescript
const renderContext = new RenderContext({
  files: generatedFiles,
  previews: {},
  mappings: {},
  prettierConfig: {
    parser: 'typescript',
    printWidth: 120,
    tabWidth: 2,
    semi: true,
    singleQuote: true,
    trailingComma: 'es5',
    bracketSpacing: true,
    arrowParens: 'avoid'
  },
  basePath: './packages/api-client/src',
  stackTrail: stack,
  logger: logger,
  captureCurrentResult: resultHandler
});

const result = await renderContext.render();

// All TypeScript files are automatically formatted
console.log('Formatted files:', Object.keys(result.artifacts).length);
```


## Example

Processing render results
```typescript
const rendered = await renderContext.render();

// Analyze file statistics
const totalLines = Object.values(rendered.files)
  .reduce((sum, file) => sum + file.lines, 0);
const totalChars = Object.values(rendered.files)
  .reduce((sum, file) => sum + file.characters, 0);

console.log(`Generated ${Object.keys(rendered.artifacts).length} files`);
console.log(`Total lines: ${totalLines}`);
console.log(`Total characters: ${totalChars}`);

// Check for large files
const largeFiles = Object.entries(rendered.files)
  .filter(([_, metadata]) => metadata.lines > 1000)
  .map(([path, metadata]) => ({ path, lines: metadata.lines }));

if (largeFiles.length > 0) {
  console.log('Large files detected:', largeFiles);
}

// Access preview and mapping data
console.log('Previews available:', Object.keys(rendered.previews));
console.log('Mappings available:', Object.keys(rendered.mappings));
```


## Example

Integration with CoreContext
```typescript
// Typically used within CoreContext.toArtifacts()
class CustomCoreContext extends CoreContext {
  async renderWithPostProcessing(
    files: Map<string, File | JsonFile>,
    previews: Record<string, Record<string, Preview>>,
    mappings: Record<string, Record<string, Mapping>>
  ) {
    const renderContext = new RenderContext({
      files,
      previews,
      mappings,
      prettierConfig: this.prettierConfig,
      basePath: this.settings?.basePath,
      stackTrail: this.stackTrail,
      logger: this.logger,
      captureCurrentResult: this.captureCurrentResult.bind(this)
    });

    const rendered = await renderContext.render();

    // Post-process rendered files
    const processedArtifacts: Record<string, string> = {};

    for (const [path, content] of Object.entries(rendered.artifacts)) {
      // Add file headers, license notices, etc.
      const processedContent = this.addFileHeader(content, path);
      processedArtifacts[path] = processedContent;
    }

    return {
      ...rendered,
      artifacts: processedArtifacts
    };
  }
}
```


## Example

Error handling during rendering
```typescript
try {
  const renderContext = new RenderContext({
    files: generatedFiles,
    previews: {},
    mappings: {},
    prettierConfig: prettierConfig,
    basePath: './invalid-path', // This might cause issues
    stackTrail: stack,
    logger: logger,
    captureCurrentResult: (result) => {
      if (result === 'error') {
        console.error('Render error detected');
      }
    }
  });

  const result = await renderContext.render();

  // Check if any files failed to render
  const failedFiles = Object.entries(result.files)
    .filter(([path, metadata]) => metadata.lines === 0)
    .map(([path]) => path);

  if (failedFiles.length > 0) {
    console.warn('Files with no content:', failedFiles);
  }

} catch (error) {
  console.error('Render operation failed:', error);
  // Sentry automatically captures the error
}
```

## Class Definition

### Constructors

- `constructor(...)`

### Properties

- `files: Map`
- `previews: Record`
- `mappings: Record`
- `basePath: string | undefined`
- `logger: Logger`
- `captureCurrentResult: (result: ResultType) =\> void`

### Methods

- `render(): Promise`
- `collate(): Promise`
- `trace(token: string | string[], fn: () =\> T): T`
- `getFile(filePath: string): File | JsonFile`
- `pick(...): Definition | undefined`

## Source

Located at `skmtc/deno/core/context/RenderContext.ts:256:0`
